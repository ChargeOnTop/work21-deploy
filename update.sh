#!/bin/bash

# ===========================================
# WORK21 - –°–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
# ===========================================
# –ó–∞–ø—É—Å–∫: chmod +x update.sh && ./update.sh

set -e

echo "üîÑ WORK21 - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤"
echo "================================"

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
echo ""
echo "üì¶ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞..."

cd backend && git pull && cd ..
echo "‚úÖ Backend –æ–±–Ω–æ–≤–ª—ë–Ω"

cd agent && git pull && cd ..
echo "‚úÖ Agent –æ–±–Ω–æ–≤–ª—ë–Ω"

cd admin && git pull && cd ..
echo "‚úÖ Admin –æ–±–Ω–æ–≤–ª—ë–Ω"

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
echo ""
echo "üîß –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤..."
docker compose build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
echo ""
echo "üöÄ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤..."
docker compose up -d

echo ""
echo "‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
echo ""
echo "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:"
echo "  docker compose logs -f"

